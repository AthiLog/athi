<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>아띠</title>
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Page 2 of 5 for 아띠 - page 2 | 아띠</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="아띠 - page 2" />
<meta name="author" content="아띠" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="아띠의 블로그" />
<meta property="og:description" content="아띠의 블로그" />
<link rel="canonical" href="https://athilog.github.io//page/2/" />
<meta property="og:url" content="https://athilog.github.io//page/2/" />
<meta property="og:site_name" content="아띠" />
<link rel="prev" href="https://athilog.github.io//" />
<link rel="next" href="https://athilog.github.io//page/3/" />
<script type="application/ld+json">
{"@type":"WebPage","url":"https://athilog.github.io//page/2/","author":{"@type":"Person","name":"아띠"},"headline":"아띠 - page 2","description":"아띠의 블로그","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="description" content="아띠의 블로그" />
    <meta name="keywords" content="React, Jekyll, dairy, 생산성, 향상, doc" />
    <meta name="author" content="아띠" />
    <link rel="shortcut icon" href="https://athilog.github.io//img/authors/favicon.ico" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://athilog.github.io//css/normalize.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://athilog.github.io//fonts/font-awesome/css/font-awesome.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://athilog.github.io//css/modern-blog.css"
    />
    <!--[if IE]>
      <script type="text/javascript" src="js/vendors/html5.min.js"></script>
    <![endif]-->
    <script>
      if (navigator.userAgent.toLowerCase().indexOf("firefox") > -1) {
        var root = document.getElementsByTagName("html")[0];
        root.setAttribute("class", "ff");
      }
    </script>
  </head>
  <body class="body">
    <div class="container">
  <header class="header">
    <a href="/" class="athi"
      ><h1>아띠<span>신중하고 조용한걸 대체로 좋아합니다. 그렇다고 활동적인걸 좋아하지 않는다는 말은 아니에요.</span></h1></a
    >
    <nav class="links">
      <a href="#"><i class="fa fa-twitter-square fa-3x"></i></a>
      <a href="#"><i class="fa fa-instagram fa-3x"></i></a>
      <a href="#"><i class="fa fa-facebook-square fa-3x"></i></a>
      <a href="#"><i class="fa fa-tumblr-square fa-3x"></i></a>
    </nav>
    <!-- 
  
  
  
<br />

<span>|</span><br />
<span>VScodeVScodeVScodebooksdockererrorsgithubgithubgithubgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoodwriting-seriesgoogle-analyticsreact-nativereact-nativereact-nativereact-nativereact-nativereact-nativereact-nativereact-native</span>

<br />

<span>VScodebooksdockererrorsgithubgoodwriting-seriesgoogle-analyticsreact-native</span>

<br />
<span>
  [ 
   
  
   
  
  <a href="/tag/VScode"
    ><code class="highligher-rouge"
      ><nobr>VScode</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/books"
    ><code class="highligher-rouge"
      ><nobr>books</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/docker"
    ><code class="highligher-rouge"
      ><nobr>docker</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/errors"
    ><code class="highligher-rouge"
      ><nobr>errors</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/github"
    ><code class="highligher-rouge"
      ><nobr>github</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/goodwriting-series"
    ><code class="highligher-rouge"
      ><nobr>goodwriting-series</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/google-analytics"
    ><code class="highligher-rouge"
      ><nobr>google-analytics</nobr></code
    >&nbsp;</a
  >
  
   
  
  <a href="/tag/react-native"
    ><code class="highligher-rouge"
      ><nobr>react-native</nobr></code
    >&nbsp;</a
  >
  
   
  ]
</span>
<br /> -->





  


  

<div style="display: block; margin-left: auto; margin-right: auto; margin-top:30px; max-width: 500px; text-align: center;" class="tags">
<span >
   
  
   
  
  <a href="/tag/VScode" class="VScodeTagLink"><code><nobr>VScode</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/books" class="booksTagLink"><code><nobr>books</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/docker" class="dockerTagLink"><code><nobr>docker</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/errors" class="errorsTagLink"><code><nobr>errors</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/github" class="githubTagLink"><code><nobr>github</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/goodwriting-series" class="goodwriting-seriesTagLink"><code><nobr>goodwriting-series</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/google-analytics" class="google-analyticsTagLink"><code><nobr>google-analytics</nobr></code>&nbsp;</a>
  
   
  
  <a href="/tag/react-native" class="react-nativeTagLink"><code><nobr>react-native</nobr></code>&nbsp;</a>
  
  
</span>
</div>
  </header>
  <div class="content">
    <!-- trianglify pattern container -->
    <div class="pattern pattern--hidden"></div>
    <!-- cards -->

    <div class="wrapper">
      
      <div class="card" data-id="/2019/06/04/circletransition">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/circletransition-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/circletransition-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/a.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">circletransition 모듈</span>
              <p class="card__subtitle">circletransition</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Easing</span><span class="p">,</span>
  <span class="nx">StyleSheet</span><span class="p">,</span>
  <span class="nx">Text</span><span class="p">,</span>
  <span class="nx">View</span><span class="p">,</span>
  <span class="nx">TouchableWithoutFeedback</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">CircleTransition</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native-expanding-circle-transition</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">ANIMATION_DURATION</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">INITIAL_VIEW_BACKGROUND_COLOR</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#E3E4E5</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">CIRCLE_COLOR1</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#29C5DB</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">CIRCLE_COLOR2</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#4EB8AE</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">CIRCLE_COLOR3</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#81C781</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">CIRCLE_COLOR4</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">#B0D882</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">TRANSITION_BUFFER</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">POSITON</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">custom</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">reactMixin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">react-mixin</span><span class="dl">"</span><span class="p">);</span>
<span class="k">import</span> <span class="nx">TimerMixin</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-timer-mixin</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Exemples</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">viewBackgroundColor</span><span class="p">:</span> <span class="nx">INITIAL_VIEW_BACKGROUND_COLOR</span><span class="p">,</span>
      <span class="na">circleColor</span><span class="p">:</span> <span class="nx">CIRCLE_COLOR1</span><span class="p">,</span>
      <span class="na">customLeftMargin</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">customTopMargin</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">counter</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">handlePress</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handlePress</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">handlePress</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">pressLocationX</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">nativeEvent</span><span class="p">.</span><span class="nx">locationX</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">pressLocationY</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">nativeEvent</span><span class="p">.</span><span class="nx">locationY</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span>
      <span class="p">{</span>
        <span class="na">customLeftMargin</span><span class="p">:</span> <span class="nx">pressLocationX</span><span class="p">,</span>
        <span class="na">customTopMargin</span><span class="p">:</span> <span class="nx">pressLocationY</span>
      <span class="p">},</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">circleTransition</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">changeColor</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">circleColor</span><span class="p">,</span> <span class="nx">counter</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">newCounter</span> <span class="o">=</span> <span class="nx">counter</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="p">?</span> <span class="nx">counter</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">newCircleColor</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getColor</span><span class="p">(</span><span class="nx">newCounter</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="na">viewBackgroundColor</span><span class="p">:</span> <span class="nx">circleColor</span><span class="p">,</span>
      <span class="na">counter</span><span class="p">:</span> <span class="nx">newCounter</span>
    <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeCircleColor</span><span class="p">(</span><span class="nx">newCircleColor</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">changeCircleColor</span><span class="p">(</span><span class="nx">newCircleColor</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">circleColor</span><span class="p">:</span> <span class="nx">newCircleColor</span>
      <span class="p">});</span>
    <span class="p">},</span> <span class="nx">TRANSITION_BUFFER</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">getColor</span><span class="p">(</span><span class="nx">counter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">counter</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">CIRCLE_COLOR1</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">CIRCLE_COLOR2</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">CIRCLE_COLOR3</span><span class="p">;</span>
      <span class="k">case</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">CIRCLE_COLOR4</span><span class="p">;</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">return</span> <span class="nx">CIRCLE_COLOR4</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="p">{</span>
      <span class="nx">circleColor</span><span class="p">,</span>
      <span class="nx">viewBackgroundColor</span><span class="p">,</span>
      <span class="nx">customTopMargin</span><span class="p">,</span>
      <span class="nx">customLeftMargin</span>
    <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span>
        <span class="nx">style</span><span class="o">=</span><span class="p">{[</span>
          <span class="nx">styles</span><span class="p">.</span><span class="nx">container</span><span class="p">,</span>
          <span class="p">{</span>
            <span class="na">backgroundColor</span><span class="p">:</span> <span class="nx">viewBackgroundColor</span>
          <span class="p">}</span>
        <span class="p">]}</span>
      <span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">TouchableWithoutFeedback</span>
          <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">touchable</span><span class="p">}</span>
          <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handlePress</span><span class="p">}</span>
        <span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">touchableView</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">viewBackgroundColor</span><span class="p">.</span><span class="nx">toString</span><span class="p">()}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/TouchableWithoutFeedback</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">CircleTransition</span>
          <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">circle</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">circleTransition</span> <span class="o">=</span> <span class="nx">circle</span><span class="p">;</span>
          <span class="p">}}</span>
          <span class="nx">color</span><span class="o">=</span><span class="p">{</span><span class="nx">circleColor</span><span class="p">}</span>
          <span class="nx">expand</span>
          <span class="nx">customTopMargin</span><span class="o">=</span><span class="p">{</span><span class="nx">customTopMargin</span><span class="p">}</span>
          <span class="nx">customLeftMargin</span><span class="o">=</span><span class="p">{</span><span class="nx">customLeftMargin</span><span class="p">}</span>
          <span class="nx">transitionBuffer</span><span class="o">=</span><span class="p">{</span><span class="nx">TRANSITION_BUFFER</span><span class="p">}</span>
          <span class="nx">duration</span><span class="o">=</span><span class="p">{</span><span class="nx">ANIMATION_DURATION</span><span class="p">}</span>
          <span class="nx">easing</span><span class="o">=</span><span class="p">{</span><span class="nx">Easing</span><span class="p">.</span><span class="nx">linear</span><span class="p">}</span>
          <span class="nx">position</span><span class="o">=</span><span class="p">{</span><span class="nx">POSITON</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">reactMixin</span><span class="p">(</span><span class="nx">Exemples</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">TimerMixin</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">container</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">flexDirection</span><span class="p">:</span> <span class="dl">"</span><span class="s2">column</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">justifyContent</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">stretch</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="na">touchableView</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">justifyContent</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="na">text</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="na">fontWeight</span><span class="p">:</span> <span class="dl">"</span><span class="s2">400</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">color</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#253039</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="na">touchable</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">flexDirection</span><span class="p">:</span> <span class="dl">"</span><span class="s2">row</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">justifyContent</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Exemples</span><span class="p">;</span>
</code></pre></div></div>

            </div>
          </div>
        </div>
      </div>
      
      <div class="card" data-id="/2019/06/04/bubble-transition">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/bubble-transition-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/bubble-transition-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/b.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">리액트 네이티브 bubble-transition 모듈</span>
              <p class="card__subtitle">bubble-transition</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <p><a href="https://codeburst.io/custom-bubble-transition-with-react-navigation-d8efca9ba83f">Custom Bubble Transitions with React Navigation</a></p>

            </div>
          </div>
        </div>
      </div>
      
      <div class="card" data-id="/2019/06/04/auth-server">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/auth-server-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/auth-server-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/c.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">서버 인증</span>
              <p class="card__subtitle">Auth Server</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <p><a href="https://medium.com/handlebar-labs/graphql-authentication-with-react-native-apollo-part-2-2-13ac8c362113">참고자료</a></p>

<h2 id="전체코드">전체코드</h2>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">makeExecutableSchema</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graphql-tools</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">MongoClient</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">mongodb</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">TEMP_USER</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">spencer@handlebarlabs.com</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">typeDefs</span> <span class="o">=</span> <span class="s2">`
  type User {
    _id: String
    email: String
  }
  type Query {
    currentUser: User
  }
  type Mutation {
    login(email: String!, password: String!): User
    signUp(email: String!, password: String!): User
  }
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">Query</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">currentUser</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">TEMP_USER</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">login</span><span class="p">:</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">passwrod</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">TEMP_USER</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="na">signup</span><span class="p">:</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">TEMP_USER</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// Required: Export the GraphQL.js schema object as "schema"</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">schema</span> <span class="o">=</span> <span class="nx">makeExecutableSchema</span><span class="p">({</span>
  <span class="nx">typeDefs</span><span class="p">,</span>
  <span class="nx">resolvers</span>
<span class="p">});</span>

<span class="c1">// Optional: Export a function to get context from the request.</span>

<span class="kd">let</span> <span class="nx">mongo</span><span class="p">;</span>

<span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">context</span><span class="p">(</span><span class="nx">headers</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mongo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">mongo</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">MongoClient</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">MONGO_URL</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">headers</span><span class="p">,</span>
    <span class="nx">secrets</span><span class="p">,</span>
    <span class="nx">mongo</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="connecting-to-thedatabase">Connecting to the Database</h2>

<p>Once you’ve set up your account with <a href="https://mlab.com">mLab</a> and created a new mongo db instance you should see a url along the lines of</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mongodb://&lt;dbuser&gt;:&lt;dbpassword&gt;@ds121665.mlab.com:21665/graphql-auth-demo-1
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 나의경우
mongodb://shiftcard:1234@ds121665.mlab.com:21665/graphql-auth-demo-1
</code></pre></div></div>

<p><code class="highlighter-rouge">launchpad apollo의 key에 MONGO_URL, value값에 위의 값 추가함</code></p>

<p>you’ll also need to create a user for that database (with write permissions). Take that url and add it to our “secrets” as <code class="highlighter-rouge">MONGO_URL</code> in Launchpad. Make sure to swap out <code class="highlighter-rouge">&lt;dbuser&gt;</code> and <code class="highlighter-rouge">&lt;dbpassword&gt;</code> with the values of the user you created.</p>

<p>By adding the secret values here we can access them from our context function, which is where we’ll be establishing our mongo connection. This context function will be called each time a request is made to a GraphQL endpoint so we want to store a reference to our connection outside of the function (allowing us to only make the db connection request once). We’ll then return the mongo variable in context so that we access it in our resolver functions.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">mongo</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">client</span><span class="p">;</span>
<span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">context</span><span class="p">(</span><span class="nx">headers</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mongo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">MongoClient</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">MONGO_URL</span><span class="p">);</span>
    <span class="nx">mongo</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">db</span><span class="p">(</span><span class="dl">"</span><span class="s2">graphql-auth-demo-1</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">headers</span><span class="p">,</span>
    <span class="nx">secrets</span><span class="p">,</span>
    <span class="nx">mongo</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Make sure you <code class="highlighter-rouge">import { MongoClient } from 'mongodb';</code> at the top of your file! Launchpad will automatically install it.</p>

<h2 id="sign-up">Sign Up</h2>

<p>Now let’s access the database from the resolver functions… first signup. We’ll get a reference to a <code class="highlighter-rouge">users</code> collection and then check if a user with the given email address already exists.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">signup</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">existingUser</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">existingUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email already used</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="c1">// TODO: Make this real</span>
      <span class="k">return</span> <span class="nx">TEMP_USER</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>We can then insert the user document into the collection. I’ll be using <code class="highlighter-rouge">bcrypt</code> to hash the user’s password, because you should never store a plain text password in your database! Make sure you import the lib:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">bcrypt</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">bcrypt</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div>

<p>I’m going to be using async/await because it makes for easy to follow code.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">signup</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">existingUser</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">existingUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email already used</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
      <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
        <span class="nx">email</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nx">hash</span><span class="p">,</span>
      <span class="p">});</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>

      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Go ahead and give it a shot in Launchpad</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">mutation</span> <span class="p">{</span>
  <span class="nx">signup</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span><span class="dl">"</span><span class="s2">c@test.com</span><span class="dl">"</span><span class="p">,</span> <span class="nx">password</span><span class="p">:</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_id</span>
    <span class="nx">email</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="login">Login</h2>

<p>The login mutation is very similar to the one we just put together.</p>

<p>First we’ll check if a user with that email address exists.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">login</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email not found</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Then we’ll compare the password supplied and the password we have stored. If they match then return the user!</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">login</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email not found</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">const</span> <span class="nx">validPassword</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">validPassword</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password is incorrect</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>So now we’ve got our sign in &amp; sign up mutations working, but that isn’t all! We don’t want to force the user to have to login with every request. Enter…</p>

<h2 id="json-webtokens">JSON Web Tokens</h2>

<blockquote>
  <p>JSON Web Token (JWT) is an open standard (<a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can be signed using a secret (with the <strong>HMAC</strong> algorithm) or a public/private key pair using <strong>RSA</strong>.</p>
</blockquote>

<p>For us this means that we can generate a JWT and use that as a means of confidently identifying a user. The flow will work like this</p>

<ol>
  <li>User logs in or signs up</li>
  <li>The server returns a JWT</li>
  <li>The client saves the JWT to their local storage (covered in part 2)</li>
  <li>The JWT is passed with each request from client to server (on the <code class="highlighter-rouge">Authorization</code> header — covered in part 2)</li>
  <li>The server uses the JWT to grab the user’s information and add it to <code class="highlighter-rouge">context</code></li>
</ol>

<blockquote>
  <p>A note on step 5: Since I wanted to keep this all browser based we need to do this manually. If you’ve got total control over the server though you can use <code class="highlighter-rouge">[express-jwt](https://www.npmjs.com/package/express-jwt)</code> to do this automatically. This is a good way to learn what that module is doing though!</p>
</blockquote>

<h3 id="the-secret">The Secret</h3>

<p>A JWT is signed with a secret value. We’ll want to come up with one and add that to the “Secrets” in Launchpad, like we did <code class="highlighter-rouge">MONGO_URL</code>. I’m storing it as <code class="highlighter-rouge">JWT_SECRET</code> with a value of <code class="highlighter-rouge">super-secret</code>.</p>

<p><code class="highlighter-rouge">launchpad apollo의 key값에 JWT_SCRET과 value값에 super-secret 추가함</code></p>

<p>Now, using that secret we’ll want to generate a new JWT and return it on the user object when they successfully login or sign up. First I’ll add <code class="highlighter-rouge">jwt</code> to the <code class="highlighter-rouge">User</code>type in our type definitions.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="p">...</span>

<span class="kd">const</span> <span class="nx">typeDefs</span> <span class="o">=</span> <span class="s2">`
  type User {
    _id: String
    email: String
    jwt: String
  }
  type Query {
    currentUser: User
  }
  type Mutation {
    login(email: String!, password: String!): User
    signup(email: String!, password: String!): User
  }
`</span><span class="p">;</span>

<span class="p">...</span>
</code></pre></div></div>

<p>Make sure you add import jwt from ‘jsonwebtoken’; to the top of your file.</p>

<h2 id="generating-the-token">Generating the Token</h2>

<p>Then, upon successful login, I’ll create a JWT. We’re passing the user’s id as part of the payload and secrets is coming from context.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">login</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span><span class="p">,</span> <span class="nx">secrets</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email not found</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">const</span> <span class="nx">validPassword</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">compare</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="nx">user</span><span class="p">.</span><span class="nx">password</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">validPassword</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password is incorrect</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="c1">// Generate the jwt and add it to the user document being returned.</span>
      <span class="nx">user</span><span class="p">.</span><span class="nx">jwt</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">_id</span> <span class="p">},</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<p>We’ll do the same for sign up.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">signup</span><span class="p">:</span> <span class="k">async</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="p">{</span> <span class="nx">mongo</span><span class="p">,</span> <span class="nx">secrets</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">mongo</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">existingUser</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">existingUser</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Email already used</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">password</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
      <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span>
        <span class="nx">email</span><span class="p">,</span>
        <span class="na">password</span><span class="p">:</span> <span class="nx">hash</span><span class="p">,</span>
      <span class="p">});</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="nx">email</span> <span class="p">});</span>

      <span class="nx">user</span><span class="p">.</span><span class="nx">jwt</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">_id</span> <span class="p">},</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">);</span>

      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="adding-the-current-user-to-context">Adding the Current User to Context</h2>

<p>Finally (for this part at least) we need to add the current user to context.</p>

<p>Remember, if you’re not using Launchpad you can use express-jwt to do this automatically. I also need to note that I’m basing this function a bit off of this launchpad which does the same thing but for the Auth0 service.</p>

<p>First, create a new function called getUser and check if we’ve got a potentially valid authorization token in the header.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getUser</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">authorization</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">,</span> <span class="nx">mongo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">bearerLength</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">authorization</span> <span class="o">&amp;&amp;</span> <span class="nx">authorization</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">bearerLength</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Then we’ll try to verify the token that was passed.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getUser</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">authorization</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">,</span> <span class="nx">mongo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">bearerLength</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">authorization</span> <span class="o">&amp;&amp;</span> <span class="nx">authorization</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">bearerLength</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">authorization</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">bearerLength</span><span class="p">);</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">ok</span><span class="p">,</span> <span class="nx">result</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span>
      <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">({</span>
            <span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">result</span><span class="p">:</span> <span class="nx">err</span>
          <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">({</span>
            <span class="na">ok</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">result</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mongo</span>
        <span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">"</span><span class="s2">users</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="p">});</span>
      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Then we’ll attempt to fetch the user from our database using the _id that we put into the jwt payload initially. ObjectId is coming from the mongdb module.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getUser</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">authorization</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">,</span> <span class="nx">mongo</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">bearerLength</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">authorization</span> <span class="o">&amp;&amp;</span> <span class="nx">authorization</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">bearerLength</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">authorization</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">bearerLength</span><span class="p">);</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">ok</span><span class="p">,</span> <span class="nx">result</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span>
      <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">({</span>
            <span class="na">ok</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">result</span><span class="p">:</span> <span class="nx">err</span>
          <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">resolve</span><span class="p">({</span>
            <span class="na">ok</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">result</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">})</span>
    <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">mongo</span>
        <span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">"</span><span class="s2">users</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="p">});</span>
      <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Finally, let’s go ahead and call this getUser function from the context function.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">context</span><span class="p">(</span><span class="nx">headers</span><span class="p">,</span> <span class="nx">secrets</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mongo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">client</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">MongoClient</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">secrets</span><span class="p">.</span><span class="nx">MONGO_URL</span><span class="p">);</span>
    <span class="nx">mongo</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">db</span><span class="p">(</span><span class="dl">"</span><span class="s2">graphql-auth-demo-1</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getUser</span><span class="p">(</span><span class="nx">headers</span><span class="p">[</span><span class="dl">"</span><span class="s2">authorization</span><span class="dl">"</span><span class="p">],</span> <span class="nx">secrets</span><span class="p">,</span> <span class="nx">mongo</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">headers</span><span class="p">,</span>
    <span class="nx">secrets</span><span class="p">,</span>
    <span class="nx">mongo</span><span class="p">,</span>
    <span class="nx">user</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We can also update the <code class="highlighter-rouge">currentUser</code> query to return the user from context.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">Query</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">currentUser</span><span class="p">:</span> <span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">context</span><span class="p">.</span><span class="nx">user</span><span class="p">;</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="p">...</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Let’s go ahead and check this out…</p>

<p>And there you have it! Runnable source code is available below</p>

            </div>
          </div>
        </div>
      </div>
      
      <div class="card" data-id="/2019/06/04/auth-client">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/auth-client-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/auth-client-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/d.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">클라이언트 인증</span>
              <p class="card__subtitle">Client Auth</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <p><a href="https://medium.com/handlebar-labs/graphql-authentication-with-react-native-apollo-part-1-2-9613aacd80b3">참고자료</a></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// app.js</span>
<span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">StackNavigator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-navigation</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// 1.0.0-beta.19</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloClient</span><span class="p">,</span> <span class="nx">HttpLink</span><span class="p">,</span> <span class="nx">InMemoryCache</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">apollo-client-preset</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">setContext</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">apollo-link-context</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Register</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Register</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Login</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Login</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Profile</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./Profile</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">signIn</span><span class="p">,</span> <span class="nx">signOut</span><span class="p">,</span> <span class="nx">getToken</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./util</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">AuthStack</span> <span class="o">=</span> <span class="nx">StackNavigator</span><span class="p">({</span>
  <span class="na">Register</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">screen</span><span class="p">:</span> <span class="nx">Register</span><span class="p">,</span>
    <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Register</span><span class="dl">"</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="na">Login</span><span class="p">:</span> <span class="p">{</span> <span class="na">screen</span><span class="p">:</span> <span class="nx">Login</span><span class="p">,</span> <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Login</span><span class="dl">"</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">LoggedInStack</span> <span class="o">=</span> <span class="nx">StackNavigator</span><span class="p">({</span>
  <span class="na">Profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">screen</span><span class="p">:</span> <span class="nx">Profile</span><span class="p">,</span> <span class="na">navigationOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">headerTitle</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Profile</span><span class="dl">"</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">httpLink</span> <span class="o">=</span> <span class="nx">newHttpLink</span><span class="p">({</span> <span class="na">uri</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://graphql서버주소</span><span class="dl">'</span><span class="p">});</span>
<span class="kd">const</span> <span class="nx">authLink</span> <span class="o">=</span> <span class="nx">setContext</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="p">{</span><span class="nx">headers</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getToken</span><span class="p">();</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="p">...</span><span class="nx">headers</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">authorization</span><span class="p">:</span> <span class="nx">token</span> <span class="p">?</span><span class="s2">`Bearer $(token)`</span> <span class="p">:</span><span class="kc">null</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">authLink</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">httpLInk</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloClient</span><span class="p">({</span>
    <span class="nx">link</span><span class="p">,</span>
    <span class="na">cache</span><span class="p">:</span> <span class="k">new</span> <span class="nx">InMemoryCache</span><span class="p">(),</span>

<span class="p">})</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">loggedIn</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="k">async</span> <span class="nx">componentWillMount</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">getToken</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">loggedIn</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">handleChangeLoginState</span> <span class="o">=</span> <span class="p">(</span><span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">jwt</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">loggedIn</span> <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">loggedIn</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">signIn</span><span class="p">(</span><span class="nx">jwt</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">signOut</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span><span class="p">(</span>
          <span class="o">&lt;</span><span class="nx">ApolloClient</span> <span class="nx">client</span><span class="o">=</span><span class="p">{</span><span class="nx">client</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">loggedIn</span> <span class="p">?</span>
            <span class="o">&lt;</span><span class="nx">LoggedInStack</span>
                <span class="nx">screenProps</span><span class="o">=</span><span class="p">{</span> <span class="na">changeLoginState</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChangeLoginState</span> <span class="p">}</span>
            <span class="sr">/</span><span class="err">&gt;
</span>             <span class="p">:</span>
            <span class="o">&lt;</span><span class="nx">AuthStack</span>
                <span class="nx">screenProps</span><span class="o">=</span><span class="p">{</span> <span class="na">changeLoginState</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChangeLoginState</span> <span class="p">}</span>
            <span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">}</span>
        <span class="o">&lt;</span><span class="sr">/AolloClient</span><span class="err">&gt;
</span>      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// util.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AsyncStorage</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">AUTH_TOKEN</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">AUTH_TOKEN</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">token</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getToken</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">token</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">token</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">signIn</span> <span class="o">=</span> <span class="nx">newToken</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">token</span> <span class="o">=</span> <span class="nx">newToken</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">,</span> <span class="nx">newToken</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">signOut</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">token</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">AsyncStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="nx">AUTH_TOKEN</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//login.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Container</span><span class="p">,</span>
  <span class="nx">Button</span><span class="p">,</span>
  <span class="nx">Content</span><span class="p">,</span>
  <span class="nx">Form</span><span class="p">,</span>
  <span class="nx">Item</span><span class="p">,</span>
  <span class="nx">Input</span><span class="p">,</span>
  <span class="nx">Text</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graphql-tag</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">password</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">handleInputChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span>
      <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">handleSubmit</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="c1">// return this.props.screenProps.changeLoginState(true);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span>
      <span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">jwt</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/email/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="sr">/password/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">emailError</span><span class="p">,</span> <span class="nx">passwordError</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Content</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Form</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Item</span> <span class="nx">error</span><span class="o">=</span><span class="p">{</span><span class="nx">emailError</span><span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Input</span>
                <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Email</span><span class="dl">"</span>
                <span class="nx">onChangeText</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleInputChange</span><span class="p">(</span><span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">)}</span>
                <span class="nx">keyboardType</span><span class="o">=</span><span class="dl">"</span><span class="s2">email-address</span><span class="dl">"</span>
                <span class="nx">autoCapitalize</span><span class="o">=</span><span class="dl">"</span><span class="s2">none</span><span class="dl">"</span>
                <span class="nx">autoCorrect</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span>
              <span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/Item</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">Item</span> <span class="nx">error</span><span class="o">=</span><span class="p">{</span><span class="nx">passwordError</span><span class="p">}</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Input</span>
                <span class="nx">placeholder</span><span class="o">=</span><span class="dl">"</span><span class="s2">Password</span><span class="dl">"</span>
                <span class="nx">onChangeText</span><span class="o">=</span><span class="p">{</span><span class="nx">value</span> <span class="o">=&gt;</span>
                  <span class="k">this</span><span class="p">.</span><span class="nx">handleInputChange</span><span class="p">(</span><span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="nx">autoCapitalize</span><span class="o">=</span><span class="dl">"</span><span class="s2">none</span><span class="dl">"</span>
                <span class="nx">autoCorrect</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span>
                <span class="nx">secureTextEntry</span>
              <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/Item</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Form</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">full</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSubmit</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Sign</span> <span class="nx">In</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/Content</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">graphql</span><span class="p">(</span>
  <span class="nx">gql</span><span class="s2">`
    mutation LogIn($email: String!, $password: String!) {
      login(email: $email, password: $password) {
        _id
        email
        jwt
      }
    }
  `</span><span class="p">,</span>
  <span class="p">{</span>
    <span class="na">props</span><span class="p">:</span> <span class="p">({</span> <span class="nx">mutate</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">login</span><span class="p">:</span> <span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">mutate</span><span class="p">({</span> <span class="na">variables</span><span class="p">:</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">}</span> <span class="p">})</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">)(</span><span class="nx">Login</span><span class="p">);</span>
</code></pre></div></div>

<p>bla</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// register.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span>
  <span class="nx">Container</span><span class="p">,</span>
  <span class="nx">Button</span><span class="p">,</span>
  <span class="nx">Content</span><span class="p">,</span>
  <span class="nx">Form</span><span class="p">,</span>
  <span class="nx">Item</span><span class="p">,</span>
  <span class="nx">Input</span><span class="p">,</span>
  <span class="nx">Text</span>
<span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span><span class="nx">graphql</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graph-tag</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Register</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">password</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">confirmPassword</span><span class="p">:</span> <span class="dl">""</span><span class="p">,</span>
      <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">handleInputChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="p">{</span>
      <span class="p">...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span>
      <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">newState</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">handleSubmit</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">confirmPassword</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">email</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">emailError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">confirmPassword</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">password</span> <span class="o">!==</span> <span class="nx">confirmPassword</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">passwordError</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="na">confirmPasswordError</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>

    <span class="c1">// return this.props.screenProps.changeLoginState(true);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span>
      <span class="p">.</span><span class="nx">signup</span><span class="p">(</span><span class="nx">email</span><span class="p">,</span> <span class="nx">passowrd</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(({</span><span class="nx">data</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">signup</span><span class="p">.</span><span class="nx">jwt</span><span class="p">)</span><span class="dl">'</span><span class="s1">
      })
      .catch(e =&gt; {
        if (/email/i.test(e.message)) {
          this.setState({ emailError: true});
        }
        if (/password/i.test(e.message)) {
          this.setState({ passwordError: true});
        }
      })

  };

  render() {
    const { navigation } = this.props;
    const { emailError, passwordError, confirmPasswordError } = this.state;

    return (
      &lt;Container&gt;
        &lt;Content&gt;
          &lt;Form&gt;
            &lt;Item error={emailError}&gt;
              &lt;Input
                placeholder="Email"
                onChangeText={value =&gt; this.handleInputChange("email", value)}
                keyboardType="email-address"
                autoCapitalize="none"
                autoCorrect={false}
              /&gt;
            &lt;/Item&gt;
            &lt;Item error={passwordError}&gt;
              &lt;Input
                placeholder="Password"
                onChangeText={value =&gt;
                  this.handleInputChange("password", value)
                }
                autoCapitalize="none"
                autoCorrect={false}
                secureTextEntry
              /&gt;
            &lt;/Item&gt;
            &lt;Item last error={confirmPasswordError}&gt;
              &lt;Input
                placeholder="Confirm Password"
                onChangeText={value =&gt;
                  this.handleInputChange("confirmPassword", value)
                }
                autoCapitalize="none"
                autoCorrect={false}
                secureTextEntry
              /&gt;
            &lt;/Item&gt;
          &lt;/Form&gt;
          &lt;Button full onPress={this.handleSubmit}&gt;
            &lt;Text&gt;Sign Up&lt;/Text&gt;
          &lt;/Button&gt;
          &lt;Button full transparent onPress={() =&gt; navigation.navigate("Login")}&gt;
            &lt;Text&gt;Sign In&lt;/Text&gt;
          &lt;/Button&gt;
        &lt;/Content&gt;
      &lt;/Container&gt;
    );
  }
}

export default graphql(
  gql`
    mutation SignUp($email: String!, $password: String!) {
      signup(email: $email, password: $password) {
        _id
        email
        jwt
      }
    }
  `,
  {
    props: ({ mutate }) =&gt; {
      signup: (email, password) =&gt; mutate({ variables: { email, passwrod } });
    }
  }
)(Register);
</span></code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// profile.js</span>

<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">View</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Container</span><span class="p">,</span> <span class="nx">Text</span><span class="p">,</span> <span class="nx">Button</span><span class="p">,</span> <span class="nx">Content</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">native-base</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-apollo</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">gql</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">graphql-tag</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Logout</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">handleLogout</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">screenProps</span><span class="p">.</span><span class="nx">changeLoginState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">currentUser</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Content</span><span class="o">&gt;</span>
          <span class="p">{</span><span class="nx">currentUser</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
              <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">currentUser</span><span class="p">.</span><span class="nx">_id</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">currentUser</span><span class="p">.</span><span class="nx">password</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>          <span class="p">)}</span>
          <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">full</span> <span class="nx">onPress</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleLogout</span><span class="p">}</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="nx">Log</span> <span class="nx">Out</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/Button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/Content</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">graphql</span><span class="p">(</span>
  <span class="nx">gql</span><span class="s2">`
    query User {
      currentUser {
        _id
        email
      }
    }
  `</span>
<span class="p">)(</span><span class="nx">Logout</span><span class="p">);</span>
</code></pre></div></div>

            </div>
          </div>
        </div>
      </div>
      
      <div class="card" data-id="/2019/06/04/react-native-align-center">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/react-native-align-center-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/react-native-align-center-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/f.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">리액트 네이티브 가운데정렬</span>
              <p class="card__subtitle">Jekyll folder's structure</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Text</span><span class="p">,</span> <span class="nx">View</span><span class="p">,</span> <span class="nx">StyleSheet</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-native</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
  <span class="na">login</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">justifyContent</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="kd">class</span> <span class="nx">Login</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">login</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span> <span class="nx">Login</span> <span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Login</span><span class="p">;</span>
</code></pre></div></div>

<p>alignItems는 가로로 가운데 정렬
justifyContent는 세로로 가운데 정렬
<img src="https://i.imgur.com/n4DVf3q.png" alt="가운데 정렬" /></p>

            </div>
          </div>
        </div>
      </div>
      
      <div class="card" data-id="/2019/06/04/set-environment">
        <div class="card__container card__container--closed">
          <svg
            class="card__image"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            viewBox="0 0 1920 1200"
            preserveAspectRatio="xMidYMid slice"
          >
            <defs>
              <clipPath id="/2019/06/04/set-environment-clip-path">
                <polygon
                  class="clip"
                  points="0,1200 0,0 1920,0 1920,1200"
                ></polygon>
              </clipPath>
            </defs>
            <image
              clip-path="url(#/2019/06/04/set-environment-clip-path)"
              width="1920"
              height="1200"
              xlink:href="/img/a.jpg"
            ></image>
          </svg>
          <div class="card__content">
            <i class="card__btn-close fa fa-times"></i>
            <div class="card__caption">
              <span class="card__title">리액트 네이티브 개발환경구성</span>
              <p class="card__subtitle">React native set environment</p>
            </div>
            <div class="card__copy">
              <div class="meta">
                <img
                  class="meta__avatar"
                  src="/img/authors/athi.png"
                />
                <span class="meta__author">Athi</span>
                <span class="meta__date">2019-06-04</span>
              </div>
              <h1 id="개발환경-구성">개발환경 구성</h1>

<p><a href="https://stackoverflow.com/questions/45182717/java-home-is-set-to-an-invalid-directory?rq=1">참고자료-환경변수</a></p>

<h2 id="개발환경을-구성할-때는-expo-init으로-하지-않고-react-native-init-project-name으로-한다">개발환경을 구성할 때는 expo init으로 하지 않고 react-native init [project name]으로 한다</h2>

<p>그래야 android, ios폴더가 생기고, react-hoooks가 가능한 최신버젼으로 다운 받을 수 있으며, product버젼엔 이게 적합하다</p>

<p><a href="https://apiko.com/blog/expo-vs-vanilla-react-native/">expo와 react-native 차이점</a></p>

<h2 id="react-native-run-android가-실행-방법">react-native run-android가 실행 방법</h2>

<p>방법 1. android studio -&gt; AVD Manager에서 애뮬레이터를 실행한 뒤에 실행가능하다.
방법 2. yarn start하고 뜨는 페이지에서 Run on Android device/emulator를 클릭한다.
방법 3. expo에선 react-native run-android 대신 expo start –android 명령어를 쓸 수 있다.</p>

<h2 id="안드로이드-스튜디오-다운">안드로이드 스튜디오 다운</h2>

<p><a href="https://yuddomack.tistory.com/entry/1React-Native-%EC%84%A4%EC%B9%98%EC%99%80-%EC%8B%A4%ED%96%89hello-world">참고자료</a></p>

<h2 id="java다운-받는곳">JAVA다운 받는곳</h2>

<p>jre가 아닌 jdk를 다운 받아야 한다.</p>

<p>아이디: rlagmlwnd3@naver.com
비번: Khj34713
<img src="https://i.imgur.com/UTlqurA.png" alt="자바 받는곳" /></p>

<h2 id="git-bash에서-java환경변수-보는법">git bash에서 JAVA환경변수 보는법</h2>

<p><code class="highlighter-rouge">echo $JAVA_HOME</code></p>

<h2 id="git-bash에서-java환경변수-설정">git bash에서 JAVA환경변수 설정</h2>

<p>bash.bashrc위치
<code class="highlighter-rouge">cd /etc/bash.bashrc</code></p>

<p>JAVA환경변수 설정
<code class="highlighter-rouge">export JAVA_HOME="C:\Program Files\Java\[JAVA버젼]"</code></p>

<p>javac환경변수 설정
<code class="highlighter-rouge">export PATH=$PATH:$JAVA_HOME/bin</code></p>

<h2 id="디바이스-상태-확인-명령어">디바이스 상태 확인 명령어</h2>

<p><code class="highlighter-rouge">adb devices</code></p>

<p><img src="https://i.imgur.com/5JdayWM.png" alt="상태" /></p>

<p>디바이스는 Nexus5 API 28로 Pie버젼으로 하는게 좋다</p>

<h1 id="에러">에러</h1>

<h2 id="react-native-run-android할-때-에러">react-native run-android할 때 에러</h2>

<p><img src="https://i.imgur.com/yov8l39.png" alt="에러" /></p>

<p>이 에러는 명령어를 실행하는 위치 혹은 상위 경로에 한글이 있어서 그렇다(자바와 관련된 문제인듯하다)</p>

            </div>
          </div>
        </div>
      </div>
      
      <!-- /cards -->
    </div>
  </div>

  <div class="pagination">
  
  <a
    href="/"
    class="previous"
    >Previous</a
  >
  
  <span class="page_number"
    >2 / 5</span
  >
  
  <a href="/page/3/" class="next"
    >Next</a
  >
  
</div>
 <!-- Global site tag (gtag.js) - Google Analytics -->
<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-143250392-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "UA-143250392-1");
</script>


  <!-- /container -->
</div>

    <!-- JS -->
    <script src="/js/vendors/trianglify.min.js"></script>
    <script src="/js/modern-blog.js"></script>
    <script src="/js/vendors/TweenMax.min.js"></script>
    <script src="/js/vendors/ScrollToPlugin.min.js"></script>
    <script src="/js/vendors/cash.min.js"></script>
    <script src="/js/card-modern-blog.js"></script>
  </body>
</html>
